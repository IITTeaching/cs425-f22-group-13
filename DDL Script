CREATE DATABASE banksystem;


CREATE TABLE Branches
 (
Address VARCHAR(20),


PRIMARY KEY (Address),
);

CREATE TABLE Customers
( 
SSN CHAR(9),
Name VARCHAR(20),
Address VARCHAR(20),
HomeBranch VARCHAR(20),


PRIMARY KEY (SSN),
FOREIGN KEY (HomeBranch) REFERENCES Branches(Address);
FOREIGN KEY (SSN) REFERENCES Owns(SSN);
);

CREATE TABLE Employees
 (
SSN CHAR(9),
Name VARCHAR(20),
Address VARCHAR(20),
Branch VARCHAR(20),
Type VARCHAR(20),
Salary DECIMAL(13,2),


PRIMARY KEY (SSN),
FOREIGN KEY (Branch) REFERENCES Branches(Address)
);

CREATE TABLE Account
 (
Number CHAR(10),
Type VARCHAR(20),
Balance DECIMAL(13,2),
Owner CHAR(9),
 
PRIMARY KEY (Number),
FOREIGN KEY (Owner) REFERENCES Customers(SSN)
);


CREATE TABLE Owns
(
SSN CHAR(9),
Number CHAR(10),


PRIMARY KEY(SSN, NUMBER),
FOREIGN KEY(Number) REFERENCES Account(Number),
FOREIGN KEY(SSN) REFERENCES Customers(SSN)
);

CREATE TABLE Transactions
 (
Type VARCHAR(20),
Amount DECIMAL(13,2),
Description VARCHAR(20),
ID CHAR(20),
DepositAccountID CHAR(10),
WithdrawalAccountID CHAR(10),
 
PRIMARY KEY (ID),
FOREIGN KEY (DepositAccountID, WithdrawalAccountID) REFERENCES Account(Number)
);




CREATE role teller;
GRANT SELECT on Account TO teller;
GRANT SELECT on Transaction TO teller
GRANT UPDATE on Transaction;


CREATE role manager;
GRANT ALL PRIVILEGES ON ALL TABLES TO manager; 
GRANT ALL PRIVILEGES ON ALL SEQUENCES TO manager;


CREATE role customer;
GRANT SELECT ON Account TO customer;
